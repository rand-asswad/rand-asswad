const PI = Math.PI;
const TAU = 2 * Math.PI;
const HALF_PI = Math.PI / 2;

function polarToCartesian(center, radius, angle) {
    return {
        x: center.x + (radius * Math.cos(angle)),
        y: center.y + (radius * Math.sin(angle))
    };
}

class Complex {
    constructor(re, im) {
        this.re = re;
        this.im = im;
    }

    abs() {
        return Math.sqrt(this.re**2 + this.im**2);
    }

    arg() {
        return Math.atan2(this.im, this.re);
    }

    conj() {
        this.im = -this.im;
    }

    add(z) {
        if (z instanceof Complex) {
            this.re += z.re;
            this.im += z.im;
        } else {
            this.re += z;
        }
    }
    
    multiply(z) {
        if (z instanceof Complex) {
            let re = this.re;
            this.re = re * z.re - this.im * z.im;
            this.im = re * z.im + this.im * z.re;
        } else {
            this.re *= z;
            this.im *= z;
        }
    }

    div(z) {
        if (z instanceof Complex) {
            let y = new Complex(z.re, z.im);
            y.inv();
            this.multiply(y);
        } else {
            this.multiply(1/z);
        }
    }

    inv() {
        let r = 1/this.abs();
        let phi = -this.arg();
        this.re = r * Math.cos(phi);
        this.im = r * Math.sin(phi);
    }
}

function add(x, y) {
    if (x instanceof Complex) {
        if (y instanceof Complex) return new Complex(x.re + y.re, x.im + y.im);
        return new Complex(x.re + y, x.im);
    }
    if (y instanceof Complex) return add(y, x);
    return new Complex(x + y, 0);
}

function prod(x, y) {
    if (x instanceof Complex) {
        if (y instanceof Complex) {
            let z = new Complex(0, 0);
            z.re = x.re * y.re - x.im * y.im;
            z.im = x.re * y.im + x.im * y.re;
            return z;
        }
        return new Complex(x.re * y, x.im * y);
    }
    if (y instanceof Complex) return multiply(y, x);
    return new Complex(x * y, 0);
}

function divide(x, y) {
    if (x instanceof Complex) {
        let z = new Complex(x.re, x.im);
        z.div(y);
        return z;
    }
    if (y instanceof Complex) {
        let z = new Complex(y.re, y.im);
        z.inv();
        return prod(x, z);
    }
    return x / y;
}

function FourierCoefs(f, nb_coefs, sym = true) {
    const coefs = [];
    const M = f.length;
    const N = (sym) ? Math.floor(nb_coefs / 2) : 0;

    for (let n = -N; n < nb_coefs - N; n++) {
        c = new Complex(0, 0);
        for (let k = 0; k < M; k++) {
            let phi = TAU * n * k / M;
            c.add(prod(f[k], new Complex(Math.cos(phi), -Math.sin(phi))));
        }
        c.div(M);
        if (!sym) c.multiply(2);
        coefs.push({index: n, re: c.re, im: c.im, r: c.abs(), arg: c.arg()});
    }

    return coefs;
}

let myPts = [
	{x: 43.29999923706055, y: 80},
	{x: 42.86229705810547, y: 79.01264953613281},
	{x: 42.251461029052734, y: 78.11994934082031},
	{x: 41.492557525634766, y: 77.34835052490234},
	{x: 40.63984298706055, y: 76.68115997314453},
	{x: 39.72898483276367, y: 76.09823608398438},
	{x: 38.74256134033203, y: 75.65187072753906},
	{x: 37.718082427978516, y: 75.30105590820312},
	{x: 36.672607421875, y: 75.01801300048828},
	{x: 35.616947174072266, y: 74.77607727050781},
	{x: 34.54521942138672, y: 74.62398529052734},
	{x: 33.46277618408203, y: 74.58831787109375},
	{x: 32.37989044189453, y: 74.60151672363281},
	{x: 31.300968170166016, y: 74.69471740722656},
	{x: 30.229642868041992, y: 74.85417938232422},
	{x: 29.162649154663086, y: 75.04007720947266},
	{x: 28.112316131591797, y: 75.30329895019531},
	{x: 27.09822654724121, y: 75.68174743652344},
	{x: 26.155271530151367, y: 76.21189880371094},
	{x: 25.336551666259766, y: 76.91715240478516},
	{x: 24.740394592285156, y: 77.81725311279297},
	{x: 24.494810104370117, y: 78.86717224121094},
	{x: 24.510255813598633, y: 79.94910430908203},
	{x: 24.658048629760742, y: 81.02186584472656},
	{x: 24.839445114135742, y: 82.08952331542969},
	{x: 25.0653076171875, y: 83.14891052246094},
	{x: 25.305147171020508, y: 84.20521545410156},
	{x: 25.57265853881836, y: 85.25479125976562},
	{x: 25.929601669311523, y: 86.27609252929688},
	{x: 26.26070213317871, y: 87.30715942382812},
	{x: 26.63890266418457, y: 88.32182312011719},
	{x: 27.103296279907227, y: 89.29998779296875},
	{x: 27.677701950073242, y: 90.21715545654297},
	{x: 28.382099151611328, y: 91.03934478759766},
	{x: 29.165924072265625, y: 91.7860107421875},
	{x: 30.03087043762207, y: 92.4371566772461},
	{x: 30.96023178100586, y: 92.9926986694336},
	{x: 31.936960220336914, y: 93.46038055419922},
	{x: 32.945106506347656, y: 93.85541534423828},
	{x: 33.99445343017578, y: 94.11991119384766},
	{x: 35.072391510009766, y: 94.21281433105469},
	{x: 36.1521110534668, y: 94.13750457763672},
	{x: 37.209144592285156, y: 93.90550994873047},
	{x: 38.22198486328125, y: 93.52388763427734},
	{x: 39.17996597290039, y: 93.01947021484375},
	{x: 40.09730529785156, y: 92.4435806274414},
	{x: 40.9786262512207, y: 91.81434631347656},
	{x: 41.7900276184082, y: 91.0977783203125},
	{x: 42.49018096923828, y: 90.2728500366211},
	{x: 43.02532196044922, y: 89.33329772949219},
	{x: 43.33636474609375, y: 88.29876708984375},
	{x: 43.45142364501953, y: 87.22209167480469},
	{x: 43.49580383300781, y: 86.13990020751953},
	{x: 43.482765197753906, y: 85.05705261230469},
	{x: 43.41713333129883, y: 83.97905731201172},
	{x: 43.74555969238281, y: 82.95123291015625},
	{x: 44.3380012512207, y: 82.04728698730469},
	{x: 45.092071533203125, y: 81.27117919921875},
	{x: 45.93013381958008, y: 80.58561706542969},
	{x: 46.856178283691406, y: 80.03173828125},
	{x: 47.89904022216797, y: 79.74934387207031},
	{x: 48.979530334472656, y: 79.71121978759766},
	{x: 50.04505157470703, y: 79.89559936523438},
	{x: 51.0497932434082, y: 80.29478454589844},
	{x: 51.462764739990234, y: 81.17304229736328},
	{x: 51.624874114990234, y: 82.2439956665039},
	{x: 51.819087982177734, y: 83.30958557128906},
	{x: 52.0512809753418, y: 84.3675537109375},
	{x: 52.327064514160156, y: 85.41495513916016},
	{x: 52.65261459350586, y: 86.44795989990234},
	{x: 53.033447265625, y: 87.46183776855469},
	{x: 53.475250244140625, y: 88.45065307617188},
	{x: 53.98234939575195, y: 89.40757751464844},
	{x: 54.558250427246094, y: 90.3246841430664},
	{x: 55.204261779785156, y: 91.19379425048828},
	{x: 55.91929244995117, y: 92.00701904296875},
	{x: 56.700199127197266, y: 92.75720977783203},
	{x: 57.54124450683594, y: 93.43933868408203},
	{x: 58.435325622558594, y: 94.05032348632812},
	{x: 59.37442398071289, y: 94.5896224975586},
	{x: 60.350589752197266, y: 95.0585708618164},
	{x: 61.362117767333984, y: 95.44502258300781},
	{x: 62.40385055541992, y: 95.74058532714844},
	{x: 63.467445373535156, y: 95.9438705444336},
	{x: 64.5445785522461, y: 96.05531311035156},
	{x: 65.62727355957031, y: 96.07662963867188},
	{x: 66.70818328857422, y: 96.01049041748047},
	{x: 67.78062438964844, y: 95.8600845336914},
	{x: 68.83856201171875, y: 95.6288070678711},
	{x: 69.87645721435547, y: 95.31969451904297},
	{x: 70.888916015625, y: 94.93533325195312},
	{x: 71.87041473388672, y: 94.47763061523438},
	{x: 72.81478118896484, y: 93.9476547241211},
	{x: 73.71485137939453, y: 93.34554290771484},
	{x: 74.56139373779297, y: 92.67034912109375},
	{x: 75.34219360351562, y: 91.92018127441406},
	{x: 76.03982543945312, y: 91.09229278564453},
	{x: 76.62934875488281, y: 90.18457794189453},
	{x: 77.08435821533203, y: 89.20247650146484},
	{x: 77.6160888671875, y: 88.25908660888672},
	{x: 78.09446716308594, y: 87.28789520263672},
	{x: 78.46298217773438, y: 86.2697982788086},
	{x: 78.74687194824219, y: 85.22461700439453},
	{x: 79.01773834228516, y: 84.17582702636719},
	{x: 79.28729248046875, y: 83.126708984375},
	{x: 79.595458984375, y: 82.08848571777344},
	{x: 80.03422546386719, y: 81.1001968383789},
	{x: 80.72689819335938, y: 80.2730941772461},
	{x: 81.65611267089844, y: 79.7398452758789},
	{x: 82.6581802368164, y: 79.32853698730469},
	{x: 83.6664047241211, y: 78.9325180053711},
	{x: 84.67821502685547, y: 78.54574584960938},
	{x: 85.69319152832031, y: 78.1673812866211},
	{x: 86.71199798583984, y: 77.79947662353516},
	{x: 87.74085998535156, y: 77.46166229248047},
	{x: 88.79654693603516, y: 77.2198715209961},
	{x: 89.86121368408203, y: 77.02056121826172},
	{x: 90.92809295654297, y: 76.83318328857422},
	{x: 91.99276733398438, y: 76.63384246826172},
	{x: 93.04774475097656, y: 76.38916778564453},
	{x: 94.06524658203125, y: 76.02274322509766},
	{x: 94.7166519165039, y: 75.23382568359375},
	{x: 94.25987243652344, y: 74.34723663330078},
	{x: 93.1921157836914, y: 74.34004211425781},
	{x: 92.14227294921875, y: 74.60545349121094},
	{x: 91.1026840209961, y: 74.90977478027344},
	{x: 90.05460357666016, y: 75.18268585205078},
	{x: 88.9835205078125, y: 75.33340454101562},
	{x: 87.9549560546875, y: 75.07113647460938},
	{x: 87.44316101074219, y: 74.14485168457031},
	{x: 87.25453186035156, y: 73.07856750488281},
	{x: 87.11959075927734, y: 72.0041732788086},
	{x: 87.06938171386719, y: 70.92266845703125},
	{x: 86.8490982055664, y: 69.86382293701172},
	{x: 86.46802520751953, y: 68.85026550292969},
	{x: 86.07598114013672, y: 67.84066009521484},
	{x: 85.76972961425781, y: 66.80204010009766},
	{x: 85.52991485595703, y: 65.74592590332031},
	{x: 85.3736343383789, y: 64.67435455322266},
	{x: 85.28155517578125, y: 63.595191955566406},
	{x: 85.20146942138672, y: 62.5150032043457},
	{x: 85.13124084472656, y: 61.434146881103516},
	{x: 84.94966888427734, y: 60.36930465698242},
	{x: 84.40929412841797, y: 59.43728256225586},
	{x: 83.616943359375, y: 58.700687408447266},
	{x: 82.85521697998047, y: 57.93133544921875},
	{x: 82.21062469482422, y: 57.061771392822266},
	{x: 81.56012725830078, y: 56.19629669189453},
	{x: 80.84927368164062, y: 55.37907791137695},
	{x: 80.09840393066406, y: 54.59857177734375},
	{x: 79.33214569091797, y: 53.83294677734375},
	{x: 78.56201934814453, y: 53.071205139160156},
	{x: 77.7794418334961, y: 52.32231903076172},
	{x: 76.97020721435547, y: 51.602413177490234},
	{x: 76.11459350585938, y: 50.93865966796875},
	{x: 75.19584655761719, y: 50.36606216430664},
	{x: 74.21572875976562, y: 49.90629577636719},
	{x: 73.18199157714844, y: 49.582916259765625},
	{x: 72.14405059814453, y: 49.273136138916016},
	{x: 71.11064910888672, y: 48.94865417480469},
	{x: 70.08595275878906, y: 48.5976448059082},
	{x: 69.07087707519531, y: 48.219581604003906},
	{x: 68.01627349853516, y: 47.98796463012695},
	{x: 66.9423828125, y: 47.846435546875},
	{x: 65.8614273071289, y: 47.78707504272461},
	{x: 64.78711700439453, y: 47.907020568847656},
	{x: 63.79683303833008, y: 48.330841064453125},
	{x: 62.94514846801758, y: 48.998817443847656},
	{x: 61.923404693603516, y: 49.29530715942383},
	{x: 60.874778747558594, y: 49.13588333129883},
	{x: 59.91769790649414, y: 49.62546157836914},
	{x: 58.93813705444336, y: 50.04610061645508},
	{x: 57.85749435424805, y: 50.020259857177734},
	{x: 56.78657913208008, y: 49.85884475708008},
	{x: 55.722068786621094, y: 49.65858459472656},
	{x: 54.659324645996094, y: 49.4489860534668},
	{x: 53.59624481201172, y: 49.2411994934082},
	{x: 52.53264617919922, y: 49.03599548339844},
	{x: 51.46814727783203, y: 48.835662841796875},
	{x: 50.400733947753906, y: 48.65138626098633},
	{x: 49.326744079589844, y: 48.51190185546875},
	{x: 48.24517059326172, y: 48.50115203857422},
	{x: 47.16683578491211, y: 48.60215759277344},
	{x: 46.08439254760742, y: 48.61851501464844},
	{x: 45.00416946411133, y: 48.5456428527832},
	{x: 43.93565368652344, y: 48.36924743652344},
	{x: 42.86970520019531, y: 48.17749786376953},
	{x: 41.80494689941406, y: 47.97841262817383},
	{x: 40.74264907836914, y: 47.766658782958984},
	{x: 39.674137115478516, y: 47.589813232421875},
	{x: 38.595237731933594, y: 47.50003433227539},
	{x: 37.51355743408203, y: 47.54105758666992},
	{x: 36.48286056518555, y: 47.85956954956055},
	{x: 35.57316589355469, y: 48.44297790527344},
	{x: 34.79627227783203, y: 49.196067810058594},
	{x: 34.1190185546875, y: 50.041011810302734},
	{x: 33.500282287597656, y: 50.929927825927734},
	{x: 32.88916015625, y: 51.824283599853516},
	{x: 32.27964401245117, y: 52.7197380065918},
	{x: 31.672340393066406, y: 53.61669158935547},
	{x: 31.068431854248047, y: 54.51591873168945},
	{x: 30.469898223876953, y: 55.4186897277832},
	{x: 29.879688262939453, y: 56.327003479003906},
	{x: 29.303916931152344, y: 57.24445724487305},
	{x: 28.756010055541992, y: 58.178775787353516},
	{x: 28.282514572143555, y: 59.152099609375},
	{x: 28.01235580444336, y: 60.20014190673828},
	{x: 27.76422882080078, y: 61.254520416259766},
	{x: 27.51575469970703, y: 62.30882263183594},
	{x: 27.267812728881836, y: 63.363285064697266},
	{x: 27.02218246459961, y: 64.41828918457031},
	{x: 26.783672332763672, y: 65.47488403320312},
	{x: 26.568408966064453, y: 66.53640747070312},
	{x: 26.456958770751953, y: 67.61226654052734},
	{x: 25.784988403320312, y: 68.34432220458984},
	{x: 25.088624954223633, y: 67.65365600585938},
	{x: 25.00945281982422, y: 66.57522583007812},
	{x: 25.017284393310547, y: 65.49201965332031},
	{x: 24.999025344848633, y: 64.40908813476562},
	{x: 24.913192749023438, y: 63.32954025268555},
	{x: 24.736520767211914, y: 62.26128005981445},
	{x: 24.501079559326172, y: 61.20450973510742},
	{x: 24.32600975036621, y: 60.135841369628906},
	{x: 24.222373962402344, y: 59.05792236328125},
	{x: 24.310619354248047, y: 57.982391357421875},
	{x: 24.798891067504883, y: 57.021724700927734},
	{x: 25.460859298706055, y: 56.16816711425781},
	{x: 25.482221603393555, y: 55.807579040527344},
	{x: 24.475473403930664, y: 55.78111267089844},
	{x: 25.389490127563477, y: 55.30857849121094},
	{x: 25.448972702026367, y: 54.3752555847168},
	{x: 24.46292495727539, y: 53.96622085571289},
	{x: 23.411497116088867, y: 53.709320068359375},
	{x: 22.478313446044922, y: 53.174617767333984},
	{x: 21.849594116210938, y: 52.301551818847656},
	{x: 21.76346778869629, y: 51.25647735595703},
	{x: 22.766355514526367, y: 50.9913444519043},
	{x: 23.818565368652344, y: 51.14568328857422},
	{x: 24.590044021606445, y: 50.59849548339844},
	{x: 25.620553970336914, y: 50.927589416503906},
	{x: 26.671804428100586, y: 51.173892974853516},
	{x: 27.652799606323242, y: 50.84471893310547},
	{x: 27.245590209960938, y: 49.9440803527832},
	{x: 26.373302459716797, y: 49.30412673950195},
	{x: 25.443023681640625, y: 48.749568939208984},
	{x: 24.49244499206543, y: 48.23026657104492},
	{x: 23.53895378112793, y: 47.716339111328125},
	{x: 22.597131729125977, y: 47.181278228759766},
	{x: 21.71843910217285, y: 46.551612854003906},
	{x: 22.358983993530273, y: 46.22405242919922},
	{x: 23.434083938598633, y: 46.14259719848633},
	{x: 24.110754013061523, y: 45.5969352722168},
	{x: 23.322734832763672, y: 44.85544204711914},
	{x: 22.41843032836914, y: 44.26692199707031},
	{x: 23.28813362121582, y: 43.81741714477539},
	{x: 24.236495971679688, y: 43.323822021484375},
	{x: 24.57469940185547, y: 42.31376266479492},
	{x: 24.284902572631836, y: 41.29680252075195},
	{x: 23.840328216552734, y: 40.309547424316406},
	{x: 23.666080474853516, y: 39.25231170654297},
	{x: 24.330692291259766, y: 38.45569610595703},
	{x: 24.495271682739258, y: 37.40288162231445},
	{x: 24.32956886291504, y: 36.33314514160156},
	{x: 24.107816696166992, y: 35.27287292480469},
	{x: 24.090452194213867, y: 34.336910247802734},
	{x: 24.66938591003418, y: 35.24687194824219},
	{x: 25.091211318969727, y: 36.2440299987793},
	{x: 25.410524368286133, y: 37.27863693237305},
	{x: 25.625383377075195, y: 38.3397216796875},
	{x: 25.735137939453125, y: 39.41702651977539},
	{x: 25.8800048828125, y: 40.39387893676758},
	{x: 26.56301498413086, y: 39.568790435791016},
	{x: 27.056354522705078, y: 38.605186462402344},
	{x: 27.44839859008789, y: 37.59591293334961},
	{x: 27.734285354614258, y: 36.551753997802734},
	{x: 27.90821647644043, y: 35.48302459716797},
	{x: 28.025789260864258, y: 34.406463623046875},
	{x: 28.516803741455078, y: 33.46841049194336},
	{x: 29.431570053100586, y: 32.89531326293945},
	{x: 30.43521499633789, y: 32.488834381103516},
	{x: 31.450563430786133, y: 32.126949310302734},
	{x: 32.38871765136719, y: 31.600479125976562},
	{x: 33.073150634765625, y: 30.776264190673828},
	{x: 33.5882682800293, y: 29.833106994628906},
	{x: 34.524375915527344, y: 29.580106735229492},
	{x: 35.2205924987793, y: 28.750699996948242},
	{x: 35.96942901611328, y: 27.971349716186523},
	{x: 36.98384094238281, y: 27.725650787353516},
	{x: 38.063743591308594, y: 27.699975967407227},
	{x: 38.56845474243164, y: 27.015201568603516},
	{x: 37.9033203125, y: 26.1916561126709},
	{x: 38.46023178100586, y: 25.37192153930664},
	{x: 39.4796142578125, y: 25.017070770263672},
	{x: 40.108375549316406, y: 24.740825653076172},
	{x: 40.85712432861328, y: 24.20939064025879},
	{x: 40.896766662597656, y: 23.127470016479492},
	{x: 41.29715347290039, y: 22.130329132080078},
	{x: 42.01198959350586, y: 21.31827163696289},
	{x: 42.557167053222656, y: 20.39829444885254},
	{x: 42.47132110595703, y: 19.334152221679688},
	{x: 42.4427604675293, y: 18.281265258789062},
	{x: 43.06121826171875, y: 17.3977108001709},
	{x: 43.799400329589844, y: 16.605897903442383},
	{x: 44.5970458984375, y: 15.873211860656738},
	{x: 45.430694580078125, y: 15.181710243225098},
	{x: 46.31431579589844, y: 14.561562538146973},
	{x: 47.31623077392578, y: 14.205843925476074},
	{x: 48.23048782348633, y: 14.743782043457031},
	{x: 49.06258773803711, y: 15.43350887298584},
	{x: 50.053749084472656, y: 15.86234188079834},
	{x: 51.125396728515625, y: 15.986729621887207},
	{x: 52.18425750732422, y: 15.775264739990234},
	{x: 53.169944763183594, y: 15.328410148620605},
	{x: 54.18566131591797, y: 14.959534645080566},
	{x: 55.258056640625, y: 14.887819290161133},
	{x: 56.33903884887695, y: 14.847497940063477},
	{x: 57.41240310668945, y: 14.703924179077148},
	{x: 58.4742317199707, y: 14.49094295501709},
	{x: 59.52230453491211, y: 14.217604637145996},
	{x: 60.555355072021484, y: 13.891940116882324},
	{x: 61.581703186035156, y: 13.546760559082031},
	{x: 62.40389633178711, y: 13.232911109924316},
	{x: 61.440067291259766, y: 13.722552299499512},
	{x: 60.59856414794922, y: 14.401419639587402},
	{x: 59.971824645996094, y: 15.272395133972168},
	{x: 60.91436004638672, y: 15.253256797790527},
	{x: 61.94465255737305, y: 14.919594764709473},
	{x: 62.95960998535156, y: 14.541257858276367},
	{x: 63.63222885131836, y: 14.253504753112793},
	{x: 62.69179916381836, y: 14.7811279296875},
	{x: 61.99813461303711, y: 15.603744506835938},
	{x: 61.70096206665039, y: 16.63528823852539},
	{x: 61.60591125488281, y: 17.713909149169922},
	{x: 61.68693161010742, y: 18.790218353271484},
	{x: 62.414695739746094, y: 19.45870018005371},
	{x: 63.39476776123047, y: 19.02699089050293},
	{x: 64.24592590332031, y: 18.357784271240234},
	{x: 64.96926879882812, y: 17.553863525390625},
	{x: 65.53987121582031, y: 16.6336727142334},
	{x: 66.22209167480469, y: 15.799920082092285},
	{x: 67.16574096679688, y: 15.277759552001953},
	{x: 68.20203399658203, y: 14.964176177978516},
	{x: 69.25514221191406, y: 14.710537910461426},
	{x: 70.31958770751953, y: 14.511022567749023},
	{x: 71.39456939697266, y: 14.378965377807617},
	{x: 72.47607421875, y: 14.322850227355957},
	{x: 73.55716705322266, y: 14.377551078796387},
	{x: 74.59056854248047, y: 14.67741584777832},
	{x: 74.66107177734375, y: 15.486176490783691},
	{x: 73.58834075927734, y: 15.463932991027832},
	{x: 72.51451873779297, y: 15.345399856567383},
	{x: 71.43441772460938, y: 15.415024757385254},
	{x: 70.37287139892578, y: 15.626547813415527},
	{x: 69.35183715820312, y: 15.984480857849121},
	{x: 68.51106262207031, y: 16.630277633666992},
	{x: 69.13827514648438, y: 17.44122886657715},
	{x: 70.05142211914062, y: 17.606477737426758},
	{x: 71.06405639648438, y: 17.986753463745117},
	{x: 72.00907897949219, y: 18.507314682006836},
	{x: 72.82471466064453, y: 19.217662811279297},
	{x: 73.87578582763672, y: 19.223350524902344},
	{x: 74.94560241699219, y: 19.05704116821289},
	{x: 76.02207946777344, y: 18.950380325317383},
	{x: 77.04122161865234, y: 19.253435134887695},
	{x: 77.76461791992188, y: 20.055810928344727},
	{x: 78.40508270263672, y: 20.928997039794922},
	{x: 79.35086822509766, y: 21.210811614990234},
	{x: 80.36011505126953, y: 21.366241455078125},
	{x: 80.62994384765625, y: 22.39776039123535},
	{x: 81.44441986083984, y: 22.98383903503418},
	{x: 82.50189971923828, y: 23.218502044677734},
	{x: 83.54862976074219, y: 23.49711036682129},
	{x: 84.53945922851562, y: 23.908754348754883},
	{x: 84.41602325439453, y: 24.929031372070312},
	{x: 84.72779846191406, y: 25.872339248657227},
	{x: 85.7371597290039, y: 26.183349609375},
	{x: 86.7753677368164, y: 25.898086547851562},
	{x: 87.83324432373047, y: 25.67529296875},
	{x: 88.91493225097656, y: 25.649372100830078},
	{x: 89.9894027709961, y: 25.78045082092285},
	{x: 91.03756713867188, y: 26.051101684570312},
	{x: 92.0366439819336, y: 26.466772079467773},
	{x: 92.87004852294922, y: 27.14628028869629},
	{x: 92.00853729248047, y: 27.254976272583008},
	{x: 90.94269561767578, y: 27.061391830444336},
	{x: 89.87303161621094, y: 26.890764236450195},
	{x: 88.7992935180664, y: 26.749277114868164},
	{x: 87.74362182617188, y: 26.921934127807617},
	{x: 86.96435546875, y: 27.644861221313477},
	{x: 86.9397964477539, y: 28.673505783081055},
	{x: 87.75211334228516, y: 29.366464614868164},
	{x: 88.82117462158203, y: 29.49936866760254},
	{x: 89.9026870727539, y: 29.449403762817383},
	{x: 90.9814453125, y: 29.351200103759766},
	{x: 92.0614242553711, y: 29.318622589111328},
	{x: 92.17755126953125, y: 30.008529663085938},
	{x: 91.09664916992188, y: 30.018390655517578},
	{x: 90.07311248779297, y: 30.35112190246582},
	{x: 89.29856872558594, y: 31.0895938873291},
	{x: 89.08358001708984, y: 32.13395309448242},
	{x: 89.30236053466797, y: 33.19321823120117},
	{x: 89.6094970703125, y: 34.2317008972168},
	{x: 90.1578140258789, y: 35.157814025878906},
	{x: 90.91284942626953, y: 35.92911148071289},
	{x: 91.8511962890625, y: 36.46305847167969},
	{x: 92.91559600830078, y: 36.61699295043945},
	{x: 93.91487121582031, y: 37.01744842529297},
	{x: 94.73737335205078, y: 37.716888427734375},
	{x: 95.37661743164062, y: 38.58921813964844},
	{x: 95.92256927490234, y: 39.50786590576172},
	{x: 96.40403747558594, y: 38.868412017822266},
	{x: 97.36116790771484, y: 39.356605529785156},
	{x: 98.23363494873047, y: 39.99837112426758},
	{x: 99.07643127441406, y: 40.678741455078125},
	{x: 99.89418029785156, y: 41.38878631591797},
	{x: 100.90629577636719, y: 41.72484588623047},
	{x: 101.90770721435547, y: 41.96098327636719},
	{x: 102.59549713134766, y: 42.79711151123047},
	{x: 103.24708557128906, y: 43.662532806396484},
	{x: 103.90254211425781, y: 44.52484130859375},
	{x: 104.41358184814453, y: 45.467952728271484},
	{x: 104.20001983642578, y: 46.519283294677734},
	{x: 104.48628997802734, y: 47.53123474121094},
	{x: 105.24748229980469, y: 48.300968170166016},
	{x: 105.76355743408203, y: 49.239952087402344},
	{x: 105.92466735839844, y: 50.305274963378906},
	{x: 105.70956420898438, y: 51.36300277709961},
	{x: 105.41807556152344, y: 52.40406036376953},
	{x: 105.64067077636719, y: 53.437618255615234},
	{x: 106.07632446289062, y: 54.4290771484375},
	{x: 106.43415832519531, y: 55.4505500793457},
	{x: 106.58800506591797, y: 56.51959991455078},
	{x: 106.37373352050781, y: 57.5738639831543},
	{x: 105.8587646484375, y: 58.525272369384766},
	{x: 105.37843322753906, y: 59.4950065612793},
	{x: 105.21484375, y: 60.52745819091797},
	{x: 105.816650390625, y: 61.38692855834961},
	{x: 105.70996856689453, y: 62.4592170715332},
	{x: 105.40348052978516, y: 63.497406005859375},
	{x: 104.97128295898438, y: 64.48993682861328},
	{x: 104.42611694335938, y: 65.42533111572266},
	{x: 103.77703857421875, y: 66.29166412353516},
	{x: 103.04718017578125, y: 67.09149932861328},
	{x: 102.42005157470703, y: 67.97386169433594},
	{x: 101.88829803466797, y: 68.9171142578125},
	{x: 101.43585968017578, y: 69.90108489990234},
	{x: 101.08098602294922, y: 70.9237060546875},
	{x: 101.28140258789062, y: 71.02759552001953},
	{x: 101.90907287597656, y: 70.1572494506836},
	{x: 102.7289810180664, y: 70.68977355957031},
	{x: 103.28508758544922, y: 71.61700439453125},
	{x: 103.6631851196289, y: 72.63097381591797},
	{x: 103.93684387207031, y: 73.67875671386719},
	{x: 104.1684341430664, y: 74.73677062988281},
	{x: 104.3069839477539, y: 75.81033325195312},
	{x: 104.34453582763672, y: 76.89280700683594},
	{x: 104.36640930175781, y: 77.97576904296875},
	{x: 104.39559173583984, y: 79.05857849121094},
	{x: 104.44639587402344, y: 80.14057922363281},
	{x: 104.51042938232422, y: 81.22186279296875},
	{x: 104.5793228149414, y: 82.30290222167969},
	{x: 104.64092254638672, y: 83.38440704345703},
	{x: 104.67416381835938, y: 84.46707153320312},
	{x: 104.64862060546875, y: 85.54966735839844},
	{x: 104.52904510498047, y: 86.62583923339844},
	{x: 104.2920150756836, y: 87.68199920654297},
	{x: 103.93864440917969, y: 88.70547485351562},
	{x: 103.51390838623047, y: 89.7017593383789},
	{x: 103.05704498291016, y: 90.68384552001953},
	{x: 102.57159423828125, y: 91.65205383300781},
	{x: 102.05604553222656, y: 92.60467529296875},
	{x: 101.50640106201172, y: 93.53789520263672},
	{x: 100.91677856445312, y: 94.44635772705078},
	{x: 100.27812957763672, y: 95.3210220336914},
	{x: 99.57707214355469, y: 96.14647674560547},
	{x: 98.79362487792969, y: 96.89329528808594},
	{x: 97.89971923828125, y: 97.50187683105469},
	{x: 96.86141204833984, y: 97.6898193359375},
	{x: 96.0328598022461, y: 97.0466537475586},
	{x: 96.07452392578125, y: 95.97811126708984},
	{x: 96.26178741455078, y: 94.91161346435547},
	{x: 96.30148315429688, y: 93.83040618896484},
	{x: 96.2262191772461, y: 92.75067138671875},
	{x: 96.02845001220703, y: 91.68604278564453},
	{x: 96.10987854003906, y: 91.30955505371094},
	{x: 97.03614044189453, y: 91.82054901123047},
	{x: 98.10750579833984, y: 91.71217346191406},
	{x: 98.9645767211914, y: 91.10323333740234},
	{x: 98.72132873535156, y: 90.1195068359375},
	{x: 98.11868286132812, y: 89.222412109375},
	{x: 97.88748931884766, y: 88.17346954345703},
	{x: 98.07685852050781, y: 87.11351013183594},
	{x: 98.66443634033203, y: 86.21607971191406},
	{x: 99.67214965820312, y: 86.01789093017578},
	{x: 100.62764739990234, y: 86.5207748413086},
	{x: 101.59524536132812, y: 86.71957397460938},
	{x: 101.74418640136719, y: 85.6767807006836},
	{x: 101.34903717041016, y: 84.67756652832031},
	{x: 100.4446792602539, y: 84.1559066772461},
	{x: 99.39771270751953, y: 83.90032958984375},
	{x: 98.56257629394531, y: 83.2204818725586},
	{x: 97.81027221679688, y: 82.4453125},
	{x: 97.16735076904297, y: 81.5738525390625},
	{x: 96.58032989501953, y: 80.6634750366211},
	{x: 95.9900131225586, y: 79.75626373291016},
	{x: 95.36781311035156, y: 80.21746063232422},
	{x: 95.89743041992188, y: 81.05107116699219},
	{x: 96.60260772705078, y: 81.85560607910156},
	{x: 97.05802917480469, y: 82.83202362060547},
	{x: 97.88297271728516, y: 82.59674072265625},
	{x: 98.66126251220703, y: 81.84514617919922},
	{x: 99.31898498535156, y: 80.9857177734375},
	{x: 99.83386993408203, y: 80.03414916992188},
	{x: 100.14514923095703, y: 79.00006103515625},
	{x: 100.09811401367188, y: 77.92341613769531},
	{x: 99.7662582397461, y: 76.89371490478516},
	{x: 99.37421417236328, y: 75.88423156738281},
	{x: 99.18801879882812, y: 74.82245635986328},
	{x: 99.45414733886719, y: 73.78147888183594},
	{x: 100.0290298461914, y: 72.86531829833984},
	{x: 100.1422348022461, y: 72.81378173828125},
	{x: 99.53425598144531, y: 73.70491790771484},
	{x: 98.9202880859375, y: 74.59677124023438},
	{x: 98.27296447753906, y: 75.46511840820312},
	{x: 97.58533477783203, y: 76.30182647705078},
	{x: 96.81936645507812, y: 77.06625366210938},
	{x: 95.94451141357422, y: 77.70376586914062},
	{x: 95.11888885498047, y: 78.39703369140625},
	{x: 94.53977966308594, y: 79.3090591430664},
	{x: 94.16805267333984, y: 80.32493591308594},
	{x: 93.96994018554688, y: 81.38890838623047},
	{x: 93.92804718017578, y: 82.47041320800781},
	{x: 94.04058837890625, y: 83.54670715332031},
	{x: 94.31983184814453, y: 84.59192657470703},
	{x: 94.79621124267578, y: 85.56327819824219},
	{x: 95.31546020507812, y: 86.51387023925781},
	{x: 95.71113586425781, y: 87.52035522460938},
	{x: 95.81941986083984, y: 88.59326171875},
	{x: 95.56056213378906, y: 89.63165283203125},
	{x: 95.48767852783203, y: 90.71116638183594},
	{x: 95.57662963867188, y: 91.7901382446289},
	{x: 95.5754165649414, y: 92.86927795410156},
	{x: 95.61571502685547, y: 93.94625854492188},
	{x: 95.75003051757812, y: 95.01799774169922},
	{x: 95.73897552490234, y: 96.10089874267578},
	{x: 95.67294311523438, y: 97.18206024169922},
	{x: 95.57321166992188, y: 98.26060485839844},
	{x: 95.44566345214844, y: 99.33604431152344},
	{x: 95.30104064941406, y: 100.40962219238281},
	{x: 95.14115142822266, y: 101.48097229003906},
	{x: 94.96615600585938, y: 102.54991912841797},
	{x: 94.77567291259766, y: 103.6162338256836},
	{x: 94.56991577148438, y: 104.67967987060547},
	{x: 94.34832763671875, y: 105.73995971679688},
	{x: 94.1107406616211, y: 106.796875},
	{x: 93.85631561279297, y: 107.84959411621094},
	{x: 93.5839614868164, y: 108.89806365966797},
	{x: 93.29170989990234, y: 109.94105529785156},
	{x: 92.97423553466797, y: 110.97662353515625},
	{x: 92.60237121582031, y: 111.99386596679688},
	{x: 92.16219329833984, y: 112.98311614990234},
	{x: 91.6588363647461, y: 113.94231414794922},
	{x: 91.1904525756836, y: 114.91893768310547},
	{x: 90.7516098022461, y: 115.9094009399414},
	{x: 90.33480072021484, y: 116.90912628173828},
	{x: 89.93128967285156, y: 117.91439056396484},
	{x: 89.53549194335938, y: 118.92242431640625},
	{x: 89.15413665771484, y: 119.93611907958984},
	{x: 88.79866027832031, y: 120.95924377441406},
	{x: 88.48751831054688, y: 121.9966812133789},
	{x: 88.24742889404297, y: 123.05257415771484},
	{x: 88.11187744140625, y: 124.12682342529297},
	{x: 88.10147094726562, y: 125.20946502685547},
	{x: 88.05284881591797, y: 126.28755187988281},
	{x: 87.62969970703125, y: 127.28227996826172},
	{x: 87.01913452148438, y: 128.17544555664062},
	{x: 86.28173065185547, y: 128.9677734375},
	{x: 85.4439468383789, y: 129.65289306640625},
	{x: 84.53275299072266, y: 130.23802185058594},
	{x: 83.94352722167969, y: 131.09320068359375},
	{x: 83.97057342529297, y: 131.9270477294922},
	{x: 83.23922729492188, y: 132.38162231445312},
	{x: 82.53423309326172, y: 133.1692657470703},
	{x: 81.47245788574219, y: 133.35302734375},
	{x: 80.43510437011719, y: 133.62693786621094},
	{x: 79.74536895751953, y: 134.44332885742188},
	{x: 79.13133239746094, y: 135.1313018798828},
	{x: 78.2979507446289, y: 134.53379821777344},
	{x: 77.8055419921875, y: 135.4837188720703},
	{x: 77.50511169433594, y: 136.5154571533203},
	{x: 77.59736633300781, y: 137.59181213378906},
	{x: 77.06298828125, y: 138.49632263183594},
	{x: 76.26799011230469, y: 139.2320556640625},
	{x: 75.50888061523438, y: 140.00474548339844},
	{x: 75.13871765136719, y: 140.95286560058594},
	{x: 75.11758422851562, y: 141.990966796875},
	{x: 74.3362808227539, y: 142.7139892578125},
	{x: 73.34956359863281, y: 143.16043090820312},
	{x: 72.38626861572266, y: 143.36483764648438},
	{x: 72.03385162353516, y: 142.38128662109375},
	{x: 72.75808715820312, y: 141.74647521972656},
	{x: 71.99275207519531, y: 141.96592712402344},
	{x: 72.08650970458984, y: 143.013916015625},
	{x: 71.50448608398438, y: 143.89772033691406},
	{x: 70.458740234375, y: 143.90911865234375},
	{x: 69.44229125976562, y: 143.5377655029297},
	{x: 68.83777618408203, y: 144.18948364257812},
	{x: 68.2962646484375, y: 145.1147918701172},
	{x: 67.40107727050781, y: 144.71878051757812},
	{x: 66.59891510009766, y: 145.30682373046875},
	{x: 65.91592407226562, y: 146.14414978027344},
	{x: 64.99674224853516, y: 146.70162963867188},
	{x: 63.9306755065918, y: 146.8748321533203},
	{x: 62.972267150878906, y: 147.31309509277344},
	{x: 62.29776382446289, y: 148.156982421875},
	{x: 61.35028076171875, y: 148.615966796875},
	{x: 60.466026306152344, y: 148.38156127929688},
	{x: 59.44855499267578, y: 148.74862670898438},
	{x: 58.467262268066406, y: 148.4884033203125},
	{x: 57.70210647583008, y: 147.86451721191406},
	{x: 56.71633529663086, y: 148.0166473388672},
	{x: 56.299476623535156, y: 147.17404174804688},
	{x: 55.3929443359375, y: 147.75363159179688},
	{x: 54.55794906616211, y: 148.44207763671875},
	{x: 53.513877868652344, y: 148.56837463378906},
	{x: 52.50367736816406, y: 148.20242309570312},
	{x: 51.72899627685547, y: 147.467041015625},
	{x: 50.663307189941406, y: 147.30715942382812},
	{x: 49.58279800415039, y: 147.3583221435547},
	{x: 48.51204299926758, y: 147.45945739746094},
	{x: 47.89103698730469, y: 146.62277221679688},
	{x: 47.490421295166016, y: 145.6177978515625},
	{x: 46.88963317871094, y: 144.71873474121094},
	{x: 46.13253402709961, y: 143.9447784423828},
	{x: 45.30249786376953, y: 143.2493896484375},
	{x: 44.41694641113281, y: 142.6258544921875},
	{x: 43.4766845703125, y: 142.0889434814453},
	{x: 42.500022888183594, y: 141.83663940429688},
	{x: 41.709224700927734, y: 141.49203491210938},
	{x: 41.172210693359375, y: 140.68714904785156},
	{x: 40.99627685546875, y: 139.6190643310547},
	{x: 40.36936569213867, y: 138.8280792236328},
	{x: 39.42512512207031, y: 139.32672119140625},
	{x: 38.4592170715332, y: 139.7938232421875},
	{x: 37.46259307861328, y: 139.4557342529297},
	{x: 36.71827697753906, y: 138.67251586914062},
	{x: 36.105873107910156, y: 137.77943420410156},
	{x: 35.55495834350586, y: 136.84718322753906},
	{x: 35.03163146972656, y: 135.8987579345703},
	{x: 34.5152587890625, y: 134.946533203125},
	{x: 33.98963928222656, y: 133.9994659423828},
	{x: 33.41023254394531, y: 133.0858154296875},
	{x: 32.49705505371094, y: 132.8063201904297},
	{x: 31.56249237060547, y: 132.87429809570312},
	{x: 31.068227767944336, y: 131.91632080078125},
	{x: 31.049964904785156, y: 130.849609375},
	{x: 31.452219009399414, y: 129.84739685058594},
	{x: 32.0150032043457, y: 128.9220733642578},
	{x: 31.50718116760254, y: 128.61778259277344},
	{x: 30.48863410949707, y: 128.7877655029297},
	{x: 30.64830207824707, y: 127.7513198852539},
	{x: 30.809364318847656, y: 126.68455505371094},
	{x: 30.599496841430664, y: 125.63501739501953},
	{x: 30.064382553100586, y: 124.69463348388672},
	{x: 29.748369216918945, y: 123.6607437133789},
	{x: 29.595441818237305, y: 122.58902740478516},
	{x: 29.566967010498047, y: 121.50682067871094},
	{x: 29.73311996459961, y: 120.43980407714844},
	{x: 29.800016403198242, y: 119.36292266845703},
	{x: 30.166852951049805, y: 118.38033294677734},
	{x: 29.717689514160156, y: 117.48136901855469},
	{x: 28.837244033813477, y: 116.85208892822266},
	{x: 28.886215209960938, y: 115.94229125976562},
	{x: 29.44549560546875, y: 115.03734588623047},
	{x: 29.437068939208984, y: 113.9609375},
	{x: 29.13559341430664, y: 112.92236328125},
	{x: 28.669580459594727, y: 111.94554901123047},
	{x: 28.06036949157715, y: 111.05168151855469},
	{x: 27.20937728881836, y: 110.74915313720703},
	{x: 26.690595626831055, y: 110.40801239013672},
	{x: 26.99523162841797, y: 109.3997802734375},
	{x: 27.98253059387207, y: 109.07756805419922},
	{x: 27.471384048461914, y: 108.62371826171875},
	{x: 26.620744705200195, y: 107.95857238769531},
	{x: 26.639602661132812, y: 107.0296859741211},
	{x: 27.370697021484375, y: 106.23112487792969},
	{x: 27.655778884887695, y: 105.2417221069336},
	{x: 26.979787826538086, y: 104.40357971191406},
	{x: 27.188596725463867, y: 103.56318664550781},
	{x: 26.758922576904297, y: 102.68946075439453},
	{x: 26.827802658081055, y: 101.6093978881836},
	{x: 26.99077606201172, y: 100.53854370117188},
	{x: 27.21066665649414, y: 99.47797393798828},
	{x: 27.48631477355957, y: 98.4306640625},
	{x: 27.866920471191406, y: 97.41828918457031},
	{x: 28.212017059326172, y: 97.9037857055664},
	{x: 28.26160430908203, y: 98.98572540283203},
	{x: 28.369102478027344, y: 100.06338500976562},
	{x: 28.560514450073242, y: 101.12908935546875},
	{x: 28.790481567382812, y: 102.18753814697266},
	{x: 29.124345779418945, y: 103.21687316894531},
	{x: 29.624267578125, y: 104.17675018310547},
	{x: 30.23871421813965, y: 105.06846618652344},
	{x: 30.901363372802734, y: 105.92510986328125},
	{x: 31.574344635009766, y: 106.77409362792969},
	{x: 32.27788162231445, y: 107.59735870361328},
	{x: 33.05570602416992, y: 108.34901428222656},
	{x: 32.95008087158203, y: 107.54039764404297},
	{x: 32.8616828918457, y: 106.47129821777344},
	{x: 33.17095947265625, y: 105.43424224853516},
	{x: 33.14322280883789, y: 104.36132049560547},
	{x: 33.74920654296875, y: 103.58333587646484},
	{x: 34.80522918701172, y: 103.35240173339844},
	{x: 35.750946044921875, y: 102.91703796386719},
	{x: 36.44620132446289, y: 102.09923553466797},
	{x: 37.485050201416016, y: 101.83233642578125},
	{x: 38.561492919921875, y: 101.92474365234375},
	{x: 39.59135818481445, y: 102.2539291381836},
	{x: 40.51835632324219, y: 102.80836486816406},
	{x: 41.2376708984375, y: 103.6102294921875},
	{x: 41.62203598022461, y: 104.61846160888672},
	{x: 42.30215072631836, y: 105.45527648925781},
	{x: 43.19068908691406, y: 106.06965637207031},
	{x: 44.19281005859375, y: 106.47634887695312},
	{x: 45.24800109863281, y: 106.71660614013672},
	{x: 46.32443618774414, y: 106.83316040039062},
	{x: 47.40427780151367, y: 106.88899230957031},
	{x: 48.46147537231445, y: 106.66744995117188},
	{x: 49.42502212524414, y: 106.17827606201172},
	{x: 50.276729583740234, y: 105.51016998291016},
	{x: 51.0677375793457, y: 104.77025604248047},
	{x: 51.865966796875, y: 104.03817749023438},
	{x: 52.72396469116211, y: 103.37832641601562},
	{x: 53.665950775146484, y: 102.8462905883789},
	{x: 54.68258285522461, y: 102.4753189086914},
	{x: 55.739444732666016, y: 102.23998260498047},
	{x: 56.8158073425293, y: 102.12325286865234},
	{x: 57.897891998291016, y: 102.14154815673828},
	{x: 58.956790924072266, y: 102.35708618164062},
	{x: 59.89049530029297, y: 102.89042663574219},
	{x: 60.590415954589844, y: 103.71499633789062},
	{x: 61.493934631347656, y: 104.29769134521484},
	{x: 62.57083511352539, y: 104.36149597167969},
	{x: 63.65045166015625, y: 104.2691421508789},
	{x: 64.7265625, y: 104.14588165283203},
	{x: 65.80694580078125, y: 104.15068054199219},
	{x: 66.8533706665039, y: 104.41951751708984},
	{x: 67.7964096069336, y: 104.94401550292969},
	{x: 68.60403442382812, y: 105.66542053222656},
	{x: 69.43717193603516, y: 106.35611724853516},
	{x: 70.35273742675781, y: 106.93325805664062},
	{x: 71.33876037597656, y: 107.37972259521484},
	{x: 72.26329040527344, y: 107.93973541259766},
	{x: 72.96527862548828, y: 108.69473266601562},
	{x: 73.33028411865234, y: 109.71405029296875},
	{x: 73.70576477050781, y: 110.72454833984375},
	{x: 74.48101043701172, y: 111.47097778320312},
	{x: 75.43547821044922, y: 111.97988891601562},
	{x: 76.45169067382812, y: 112.3539047241211},
	{x: 76.7470932006836, y: 111.48394012451172},
	{x: 76.97028350830078, y: 110.42415618896484},
	{x: 77.25897979736328, y: 109.38044738769531},
	{x: 77.61786651611328, y: 108.35850524902344},
	{x: 78.0492172241211, y: 107.36503601074219},
	{x: 78.55135345458984, y: 106.40554809570312},
	{x: 79.11892700195312, y: 105.48361206054688},
	{x: 79.7821273803711, y: 104.62797546386719},
	{x: 80.53848266601562, y: 103.85318756103516},
	{x: 81.3738021850586, y: 103.16448211669922},
	{x: 82.26599884033203, y: 102.55027770996094},
	{x: 83.1887435913086, y: 101.98320770263672},
	{x: 84.11637878417969, y: 101.42436218261719},
	{x: 85.02288818359375, y: 100.83145141601562},
	{x: 85.87876892089844, y: 100.1684341430664},
	{x: 86.65486907958984, y: 99.41371154785156},
	{x: 87.32937622070312, y: 98.56694793701172},
	{x: 87.89449310302734, y: 97.64347076416016},
	{x: 88.35621643066406, y: 96.6640853881836},
	{x: 88.73602294921875, y: 95.64965057373047},
	{x: 89.07404327392578, y: 94.6207275390625},
	{x: 89.37459564208984, y: 93.5799560546875},
	{x: 89.6386947631836, y: 92.52947235107422},
	{x: 89.86742401123047, y: 91.4708023071289},
	{x: 90.06158447265625, y: 90.40496063232422},
	{x: 90.2216567993164, y: 89.33372497558594},
	{x: 90.34805297851562, y: 88.2579116821289},
	{x: 90.44007110595703, y: 87.17864990234375},
	{x: 90.49637603759766, y: 86.09698486328125},
	{x: 90.51213073730469, y: 85.01400756835938},
	{x: 90.48854064941406, y: 83.93122863769531},
	{x: 90.48698425292969, y: 82.84786987304688},
	{x: 90.0958023071289, y: 81.8943099975586},
	{x: 89.232177734375, y: 81.24049377441406},
	{x: 88.40076446533203, y: 80.54646301269531},
	{x: 87.82323455810547, y: 79.86860656738281},
	{x: 88.41559600830078, y: 78.97368621826172},
	{x: 88.8712158203125, y: 77.99105072021484},
	{x: 89.32868957519531, y: 77.00921630859375},
	{x: 89.8272705078125, y: 76.04779052734375},
	{x: 90.40560150146484, y: 75.13277435302734},
	{x: 91.12561798095703, y: 74.32664489746094},
	{x: 92.07318115234375, y: 73.82655334472656},
	{x: 93.14944458007812, y: 73.87479400634766},
	{x: 94.1839370727539, y: 74.17757415771484},
	{x: 93.67813110351562, y: 74.89576721191406},
	{x: 92.6694107055664, y: 75.27850341796875},
	{x: 91.5919189453125, y: 75.36345672607422},
	{x: 90.50994873046875, y: 75.3145980834961},
	{x: 89.42691802978516, y: 75.30244445800781},
	{x: 88.34734344482422, y: 75.38311004638672},
	{x: 87.27572631835938, y: 75.52547454833984},
	{x: 86.19445037841797, y: 75.59034729003906},
	{x: 85.11312866210938, y: 75.65522766113281},
	{x: 84.03193664550781, y: 75.72010040283203},
	{x: 82.9505615234375, y: 75.78498840332031},
	{x: 81.87561798095703, y: 75.91264343261719},
	{x: 80.80557250976562, y: 76.07999420166016},
	{x: 79.74244689941406, y: 76.28609466552734},
	{x: 79.6539077758789, y: 76.90504455566406},
	{x: 80.5372543334961, y: 77.5046615600586},
	{x: 79.93363189697266, y: 78.15350341796875},
	{x: 79.20082092285156, y: 77.73136138916016},
	{x: 79.31195068359375, y: 76.66854095458984},
	{x: 80.08236694335938, y: 75.93708801269531},
	{x: 81.15714263916016, y: 75.85611724853516},
	{x: 82.2372817993164, y: 75.77464294433594},
	{x: 81.22639465332031, y: 75.9628677368164},
	{x: 80.19332122802734, y: 75.65087127685547},
	{x: 79.1957015991211, y: 75.22848510742188},
	{x: 78.19801330566406, y: 74.80612182617188},
	{x: 77.1918716430664, y: 74.40504455566406},
	{x: 76.1745376586914, y: 74.0333480834961},
	{x: 75.14586639404297, y: 73.69515228271484},
	{x: 74.10589599609375, y: 73.39241027832031},
	{x: 73.05565643310547, y: 73.12644958496094},
	{x: 71.996826171875, y: 72.89806365966797},
	{x: 70.93054962158203, y: 72.70742797851562},
	{x: 69.85834503173828, y: 72.5545654296875},
	{x: 68.78117370605469, y: 72.43901824951172},
	{x: 67.70098876953125, y: 72.36029052734375},
	{x: 66.6181869506836, y: 72.31759643554688},
	{x: 65.53509521484375, y: 72.31043243408203},
	{x: 64.45220184326172, y: 72.33746337890625},
	{x: 63.370880126953125, y: 72.39801788330078},
	{x: 62.29168701171875, y: 72.49076080322266},
	{x: 61.21282958984375, y: 72.58875274658203},
	{x: 60.144344329833984, y: 72.76597595214844},
	{x: 59.09446716308594, y: 73.03190612792969},
	{x: 58.07065200805664, y: 73.3841781616211},
	{x: 57.07192611694336, y: 73.80289459228516},
	{x: 56.10756301879883, y: 74.29548645019531},
	{x: 55.18295669555664, y: 74.85919189453125},
	{x: 54.302249908447266, y: 75.48963928222656},
	{x: 53.4679069519043, y: 76.18029022216797},
	{x: 52.67856216430664, y: 76.92182159423828},
	{x: 52.44664001464844, y: 77.95023345947266},
	{x: 52.571693420410156, y: 79.02534484863281},
	{x: 52.72697067260742, y: 80.0966567993164},
	{x: 52.873104095458984, y: 81.16992950439453},
	{x: 53.03429412841797, y: 82.2411117553711},
	{x: 53.29060363769531, y: 83.29266357421875},
	{x: 53.63336181640625, y: 84.32022857666016},
	{x: 53.98278045654297, y: 85.34523010253906},
	{x: 54.34559631347656, y: 86.36543273925781},
	{x: 54.758636474609375, y: 87.36675262451172},
	{x: 55.242549896240234, y: 88.33534240722656},
	{x: 55.80549621582031, y: 89.26041412353516},
	{x: 56.46339416503906, y: 90.1195297241211},
	{x: 57.223880767822266, y: 90.89035034179688},
	{x: 58.057212829589844, y: 91.581787109375},
	{x: 58.951324462890625, y: 92.19216918945312},
	{x: 59.898197174072266, y: 92.71739196777344},
	{x: 60.889625549316406, y: 93.15266418457031},
	{x: 61.915374755859375, y: 93.50019836425781},
	{x: 62.965904235839844, y: 93.7618408203125},
	{x: 64.0377197265625, y: 93.9140853881836},
	{x: 65.11944580078125, y: 93.96363067626953},
	{x: 66.2018814086914, y: 93.93037414550781},
	{x: 67.28087615966797, y: 93.83657836914062},
	{x: 68.35514068603516, y: 93.69832611083984},
	{x: 69.42644500732422, y: 93.53861236572266},
	{x: 70.48304748535156, y: 93.30380249023438},
	{x: 71.49241638183594, y: 92.91549682617188},
	{x: 72.41160583496094, y: 92.34565734863281},
	{x: 73.24706268310547, y: 91.65653228759766},
	{x: 74.0299301147461, y: 90.9081039428711},
	{x: 74.75635528564453, y: 90.10501861572266},
	{x: 75.42308807373047, y: 89.25166320800781},
	{x: 76.02767181396484, y: 88.35324096679688},
	{x: 76.5685806274414, y: 87.41509246826172},
	{x: 77.04532623291016, y: 86.4427261352539},
	{x: 77.45775604248047, y: 85.4415054321289},
	{x: 77.80645751953125, y: 84.416015625},
	{x: 78.07720947265625, y: 83.36795043945312},
	{x: 78.26880645751953, y: 82.3020248413086},
	{x: 78.35173034667969, y: 81.2226791381836},
	{x: 78.27812957763672, y: 80.14328002929688},
	{x: 78.05543518066406, y: 79.0838623046875},
	{x: 77.70936584472656, y: 78.05818176269531},
	{x: 77.24645233154297, y: 77.07962799072266},
	{x: 76.6712417602539, y: 76.16221618652344},
	{x: 75.94120025634766, y: 75.36321258544922},
	{x: 75.11143493652344, y: 74.6678237915039},
	{x: 74.19139099121094, y: 74.10037994384766},
	{x: 73.168701171875, y: 73.74783325195312},
	{x: 72.1007080078125, y: 73.62529754638672},
	{x: 71.0207290649414, y: 73.71076202392578},
	{x: 69.94020080566406, y: 73.78784942626953},
	{x: 68.85953521728516, y: 73.85696411132812},
	{x: 67.77782440185547, y: 73.91835021972656},
	{x: 66.69605255126953, y: 73.97132873535156},
	{x: 65.61360931396484, y: 74.00350952148438},
	{x: 64.53155517578125, y: 74.05207061767578},
	{x: 63.45353317260742, y: 74.15790557861328},
	{x: 62.3819694519043, y: 74.3146743774414},
	{x: 61.315948486328125, y: 74.50656127929688},
	{x: 60.252628326416016, y: 74.71280670166016},
	{x: 59.19184494018555, y: 74.9324722290039},
	{x: 58.14028549194336, y: 75.19203186035156},
	{x: 57.10768508911133, y: 75.51824951171875},
	{x: 56.112213134765625, y: 75.94464874267578},
	{x: 55.17713928222656, y: 76.48922729492188},
	{x: 54.33987045288086, y: 77.1752700805664},
	{x: 53.566444396972656, y: 77.93356323242188},
	{x: 52.574310302734375, y: 77.9085922241211},
	{x: 51.50669479370117, y: 77.72574615478516},
	{x: 50.429935455322266, y: 77.61018371582031},
	{x: 49.347843170166016, y: 77.56304168701172},
	{x: 48.26513671875, y: 77.58753204345703},
	{x: 47.18695068359375, y: 77.68858337402344},
	{x: 46.11954116821289, y: 77.87199401855469},
	{x: 45.07154083251953, y: 78.14403533935547},
	{x: 44.19075012207031, y: 77.87999725341797},
	{x: 43.39095687866211, y: 77.14972686767578},
	{x: 42.53715515136719, y: 76.48383331298828},
	{x: 41.633460998535156, y: 75.88715362548828},
	{x: 40.685935974121094, y: 75.3631591796875},
	{x: 39.70071792602539, y: 74.91355895996094},
	{x: 38.684730529785156, y: 74.53871154785156},
	{x: 37.64474105834961, y: 74.23741149902344},
	{x: 36.58647537231445, y: 74.0072250366211},
	{x: 35.515750885009766, y: 73.84514617919922},
	{x: 34.436920166015625, y: 73.7477035522461},
	{x: 33.35417938232422, y: 73.71122741699219},
	{x: 32.27137756347656, y: 73.73218536376953},
	{x: 31.190683364868164, y: 73.80730438232422},
	{x: 30.11490249633789, y: 73.93376922607422},
	{x: 29.045982360839844, y: 74.10923767089844},
	{x: 27.986114501953125, y: 74.33193969726562},
	{x: 26.936845779418945, y: 74.60135650634766},
	{x: 25.900968551635742, y: 74.91773223876953},
	{x: 24.877967834472656, y: 75.2732162475586},
	{x: 23.816505432128906, y: 75.48556518554688},
	{x: 22.755460739135742, y: 75.69912719726562},
	{x: 22.41694450378418, y: 76.60310363769531},
	{x: 22.443490982055664, y: 77.68547821044922},
	{x: 22.619144439697266, y: 78.7300796508789},
	{x: 23.417158126831055, y: 78.46343231201172},
	{x: 23.149690628051758, y: 77.58796691894531},
	{x: 22.08248519897461, y: 77.61351776123047},
	{x: 21.72762107849121, y: 78.59469604492188},
	{x: 21.544090270996094, y: 79.62798309326172},
	{x: 22.36906623840332, y: 80.3254623413086},
	{x: 23.00967025756836, y: 81.19657897949219},
	{x: 23.49017333984375, y: 82.16637420654297},
	{x: 23.857725143432617, y: 83.18486022949219},
	{x: 24.15632438659668, y: 84.22615051269531},
	{x: 24.42177391052246, y: 85.27619171142578},
	{x: 24.684707641601562, y: 86.32695770263672},
	{x: 24.97390365600586, y: 87.3706283569336},
	{x: 25.3206844329834, y: 88.39688110351562},
	{x: 25.75987434387207, y: 89.38629913330078},
	{x: 26.329240798950195, y: 90.30651092529297},
	{x: 27.01803207397461, y: 91.1422348022461},
	{x: 27.762969970703125, y: 91.92838287353516},
	{x: 28.5526180267334, y: 92.6697998046875},
	{x: 29.402584075927734, y: 93.33995819091797},
	{x: 30.311779022216797, y: 93.92790222167969},
	{x: 31.272586822509766, y: 94.42671966552734},
	{x: 32.27898406982422, y: 94.82616424560547},
	{x: 33.32248306274414, y: 95.1156997680664},
	{x: 34.39126205444336, y: 95.28561401367188},
	{x: 35.47285079956055, y: 95.32768249511719},
	{x: 36.55021667480469, y: 95.22525024414062},
	{x: 37.59516525268555, y: 94.94490814208984},
	{x: 38.58797073364258, y: 94.51416015625},
	{x: 39.51906204223633, y: 93.96178436279297},
	{x: 40.38453674316406, y: 93.31117248535156},
	{x: 41.1837272644043, y: 92.5805435180664},
	{x: 41.91728210449219, y: 91.7840347290039},
	{x: 42.5864143371582, y: 90.93238067626953},
	{x: 43.19233322143555, y: 90.03463745117188},
	{x: 43.73631286621094, y: 89.09834289550781},
	{x: 44.21979522705078, y: 88.12892150878906},
	{x: 44.643768310546875, y: 87.13214111328125},
	{x: 45.00927734375, y: 86.11251068115234},
	{x: 45.317501068115234, y: 85.07398986816406},
	{x: 45.569488525390625, y: 84.02063751220703},
	{x: 45.76641082763672, y: 82.95590209960938},
	{x: 45.90939712524414, y: 81.88230895996094},
	{x: 45.99980926513672, y: 80.80320739746094},
	{x: 43.29999923706055, y: 80}
];

const ns = 'http://www.w3.org/2000/svg';

class Element {
    constructor(parent, tag, attr) {
        this._node = document.createElementNS(ns, tag);
        if (parent instanceof Element) {
            this._parent = parent;
            parent.node.appendChild(this._node);
        } else {
            this._parent = document.getElementById(parent);
            this._parent.appendChild(this._node);
        }
        if (attr) Object.keys(attr).forEach((key, index) => {
            this.setAttribute(key, attr[key]);
        });
    }
    
    getAttribute(name) {return this._node.getAttribute(name);}
    setAttribute(name, value) {if (value) this._node.setAttributeNS(null, name, value);}
    removeAttribute(name) {this._node.removeAttribute(name);}

    get node() {return this._node;}
    get parent() {return this._parent;}
    set id(str) {this.setAttribute('id', str);}
    set class(str) {this.setAttribute('class', str);}

    createElement(tag, attr) {
        return createElement(this, tag, attr);
    }
}

function createElement(parent, tag, attr) {
    if (tag == 'circle') return new Circle(parent, attr);
    if (tag == 'line') return new Line(parent, attr);
    if (tag == 'polyline') return new Polyline(parent, attr);
    return new Element(parent, tag, attr);
}

class SVG extends Element {
    constructor(parent) {
        super(parent, "svg");
    }

    set viewBox(str) {this.setAttribute('viewBox', str);}
    set width(str) {this.setAttribute('width', str);}
    set height(str) {this.setAttribute('height', str);}
}

class Circle extends Element {
    constructor(parent, attr) {
        super(parent, "circle", attr);
    }

    get radius() {return this.getAttribute('r');}
    get center() {
        return {
            x: this.getAttribute('cx'),
            y: this.getAttribute('cy')
        }
    }

    set radius(r) {this.setAttribute('r', r);}
    set center(c) {
        this.setAttribute('cx', c.x);
        this.setAttribute('cy', c.y);
    }
}

class Line extends Element {
    constructor(parent, attr) {
        super(parent, 'line', attr);
    }

    get start() {
        return {
            x: this.getAttribute('x1'),
            y: this.getAttribute('y1')
        }
    }
    
    get end() {
        return {
            x: this.getAttribute('x2'),
            y: this.getAttribute('y2')
        }
    }

    set start(point) {
        this.setAttribute('x1', point.x);
        this.setAttribute('y1', point.y);
    }
    
    set end(point) {
        this.setAttribute('x2', point.x);
        this.setAttribute('y2', point.y);
    }
}

class Polyline extends Element {
    constructor(parent, attr) {
        super(parent, 'polyline', attr);
        this.length = 0;
    }

    push(point) {
        let pts = this.getAttribute('points');
        if (pts) pts += ' ' + point.x + ',' + point.y;
        else pts = point.x + ',' + point.y;
        this.setAttribute('points', pts);
        this.length++;
    }

    pop() {
        let pts = this.getAttribute('points');
        if (pts && this.length > 0) {
            let ind = pts.indexOf(' ');
            if (ind == -1) {
                this.setAttribute('points', '');
                this.length = 0;
            }
            else {
                this.setAttribute('points', pts.substr(ind + 1));
                this.length--;
            }
        }
    }
}

class FourierSketch {
    constructor(dataSrc, div, nb_coefs=null, period=1, skip=1) {
        this.canvas = new SVG(div);
        this.path = this.canvas.createElement("polyline", {id:"path"});
        this.vectors = this.canvas.createElement("g", {id:"vectors"});
        this.epicycles = this.canvas.createElement("g", {id:"epicycles"});
        this.cycle = [];
        this.vector = [];

        this.preprocess(dataSrc, skip);
        this.length = this._f.length;
        if (!nb_coefs) nb_coefs = this.length;
        this.coefs = FourierCoefs(this._f, nb_coefs);
        this.coefs.sort((a, b) => b.r - a.r);

        this.initDrawing();
        this.nbCoefs = Math.floor(this.coefs.length);

        this._play = true;
        this.current_frame = 0;
        this.time_interval = 1000 * period / this.length;
    }

    set nbCoefs(nb) {
        this.nb_coefs = (nb > this.coefs.length) ? this.coefs.length:nb;
        let N = Math.floor(nb / 2);
        this.index = this.generate_index(-N, this.nb_coefs - N);
        this.partialSeries();
    }

    generate_index(start, stop) {
        let index = new Array();
        for (let n = 0; n < this.coefs.length; n++) {
            if (this.coefs[n].index >= start && this.coefs[n].index < stop) {
                index.push(n);
                this.cycle[n].setAttribute("visibility", "visible");
                this.vector[n].setAttribute("visibility", "visible");
            } else {
                this.cycle[n].setAttribute("visibility",  "hidden");
                this.vector[n].setAttribute("visibility", "hidden");
            }
        }
        return index;
    }

    preprocess(data, skip) {
        this._f = [];
        let xlim = {min: Infinity, max: -Infinity};
        let ylim = {min: Infinity, max: -Infinity};
        for (let i = 0; i < data.length; i+=skip) {
            const x = data[i].x;
            const y = data[i].y;
            const c = new Complex(x, y);
            this._f.push(c);
            xlim.min = (x < xlim.min) ? x : xlim.min;
            xlim.max = (x > xlim.max) ? x : xlim.max;
            ylim.min = (y < ylim.min) ? y : ylim.min;
            ylim.max = (y > ylim.max) ? y : ylim.max;
        }
        let dim = {width: xlim.max - xlim.min, height: ylim.max - ylim.min};
        let center = {x: (xlim.min + xlim.max) / 2, y: (ylim.min + ylim.max) / 2};
        for (let i = 0; i < this._f.length; i++) {
            this._f[i].re -= center.x;
            this._f[i].im -= center.y;
        }
        let margin = (dim.width + dim.height) / 4;
        let viewBox = [
            -dim.width/2 - margin, -dim.height/2 - margin,
            dim.width+2*margin, dim.height+2*margin
        ];
        this.canvas.width  = "100%";//dim.width;
        this.canvas.height = "100%";//dim.height;
        this.canvas.viewBox = viewBox.join(' ');
    }

    partialSeries() {
        // partial[k][n] = cumulative sum of the first n coefs at instant t[k]
        this.partial = new Array(this.length);
        for (let k = 0; k < this.length; k++) {
            let x = 0, y = 0;
            this.partial[k] = new Array(this.nb_coefs);
            for (let n = 0; n < this.nb_coefs; n++) {
                let coef = copy(this.coefs[this.index[n]]);
                let phase = coef.arg + coef.index * TAU * k / this.length;
                x += coef.r * Math.cos(phase);
                y += coef.r * Math.sin(phase);
                this.partial[k][n] = copy({x: x, y: y});
            }
        }
    }

    initDrawing() {
        this.epicycles.setAttribute("fill", "none");
        this.epicycles.setAttribute("stroke", "black");
        this.epicycles.setAttribute("stroke-width", ".3");
        this.vectors.setAttribute("fill", "none");
        this.vectors.setAttribute("stroke", "grey");
        this.vectors.setAttribute("stroke-width", ".3");
        this.path.setAttribute("fill", "none");
        this.path.setAttribute("stroke", "black");
        for (let n = 0; n < this.coefs.length; n++) {
            this.cycle.push(this.epicycles.createElement("circle", {id: this.coefs.index}));
            this.vector.push(this.vectors.createElement("line"));
        }
    }

    drawFrame(k) {
        let prev = {x: 0, y: 0};
        this.index.forEach(n => {
            // draw cycle
            this.cycle[n].center = copy(prev);
            this.cycle[n].radius = this.coefs[n].r;

            // draw vector
            this.vector[n].start = copy(prev);
            this.vector[n].end   = copy(this.partial[k][n]);

            prev = copy(this.partial[k][n]);
        });
        if (this.path.length >= this.length) this.path.pop();
        this.path.push(prev);
    }

    animate() {
        this._play = true;
        setInterval(() => {
            if (this._play) {
                this.drawFrame(this.current_frame++);
                if (this.current_frame >= this.length) this.current_frame = 0;
            }
        }, this.time_interval);
        this.canvas.parent.addEventListener("click", (e) => {
            this._play = !this._play;
        });
    }

    play() {this._play = true;}
    pause() {this._play = false;}

    controlSlider(id) {
        var slider = document.getElementById(id);
        slider.setAttribute("max", this.coefs.length);
        slider.setAttribute("value", this.nb_coefs);
        slider.addEventListener("change", (e) => {
            this.nbCoefs = e.target.value;
        });
    }
}

function copy(obj) {
    return Object.assign({}, obj);
}

var sketch = new FourierSketch(myPts, "sketch-holder", 400, 20, 2);
sketch.canvas.viewBox = "-90 -100 170 200";
sketch.path.setAttribute("stroke", "#2E9CCA");
sketch.epicycles.setAttribute("stroke", "#AAABB8");
sketch.vectors.setAttribute("stroke", "#29648A");
sketch.animate();